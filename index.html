<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src='//whephiwums.com/sdk.js' data-zone='9005441' data-sdk='show_9005441'></script>
    
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fff3e0;
            color: #333;
        }

        .navbar {
            display: flex;
            justify-content: space-around;
            background-color: #ff9800;
            padding: 10px;
            color: white;
            position: fixed;
            bottom: 0;
            width: 100%;
            box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
        }

        .navbar button {
            background: none;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            padding: 10px;
            transition: background-color 0.3s;
        }

        .navbar button:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }

        .container {
            padding: 20px;
            margin-bottom: 70px;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .feature-card button {
            background-color: #ff9800;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .feature-card button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .profile {
            text-align: center;
        }

        .profile img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-bottom: 10px;
        }

        .leaderboard-container {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 10px;
            background-color: white;
            padding: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        #leaderboardList {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        #leaderboardList li {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s;
        }

        #leaderboardList li:last-child {
            border-bottom: none;
        }

        #leaderboardList li:hover {
            background-color: #f9f9f9;
        }

        #leaderboardList li.top-three {
            background-color: #ffeb3b;
            font-weight: bold;
            color: #333;
        }

        #leaderboardList li.top-three:nth-child(1) {
            background-color: #ffd700;
        }

        #leaderboardList li.top-three:nth-child(2) {
            background-color: #c0c0c0;
        }

        #leaderboardList li.top-three:nth-child(3) {
            background-color: #cd7f32;
        }

        .loading {
            text-align: center;
            font-size: 18px;
            color: #ff9800;
        }

        .user-info {
            text-align: center;
            margin-bottom: 20px;
        }

        .user-info img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
        }

        .user-info p {
            margin: 5px 0;
            font-size: 18px;
            font-weight: 500;
        }

        .announcement {
            background-color: #ff9800;
            color: white;
            padding: 10px;
            text-align: center;
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 20px;
        }

        .game-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
        }


        .game-canvas {
            border: 2px solid #ff9800;
            border-radius: 10px;
            margin: 10px auto;
            display: block;
        }

        .game-info {
            margin-top: 20px;
            font-size: 18px;
        }

        .game-button {
            background: #ff9800;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
        }

        #gameBoard {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px auto;
            max-width: 300px;
        }

        .cell {
            aspect-ratio: 1;
            background: #fff3e0;
            border: 2px solid #ff9800;
            border-radius: 10px;
            font-size: 40px;
            font-weight: bold;
            color: #ff5722;
            cursor: pointer;
            transition: all 0.3s;
        }

        .cell:hover {
            background: #ffe0b2;
        }

        .game-info {
            margin-top: 20px;
            font-size: 18px;
        }

        #resetGame {
            background: #ff9800;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <div class="announcement">
        üåü‡¶ó‡¶ø‡¶≠‡¶ì‡¶Ø‡¶º‡ßá ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶∏‡ßç‡¶üüåü<br>üîò‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßÅ‡¶®üîò<br>üåü‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°‡ßá ‡¶∂‡ßÄ‡¶∞‡ßç‡¶∑‡ßá ‡¶•‡¶æ‡¶ï‡ßÅ‡¶®üåü<br>üëâ‡¶∞‡ßÅ‡¶≤‡¶∏ ‡¶Æ‡ßá‡¶®‡ßá ‡¶Ö‡¶Ç‡¶∂‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶®‡¶æ ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ó‡¶®‡ßç‡¶Ø ‡¶π‡¶¨‡ßá‡¶®‡¶æüëà
    </div>

    <div class="navbar">
        <button onclick="showHome()">‡¶π‡ßã‡¶Æ</button>
        <button onclick="showEarning()">‡¶∞‡ßÅ‡¶≤‡¶∏</button>
        <button onclick="showLeaderboard()">‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°</button>
        <button onclick="showProfile()">‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</button>
    </div>

    <div class="container" id="home">
        <div class="user-info">
            <img id="dashboardProfilePic" src="" alt="‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶õ‡¶¨‡¶ø">
            <p>‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü: <span id="dashboardPoints">0</span></p>
        </div>
        <h2>‡¶π‡ßã‡¶Æ</h2>
        <div class="dashboard">
            <div class="feature-card">
                <h3>‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏</h3>
                <button id="dailyBonusBtn" onclick="claimDailyBonus()">‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶®‡¶ø‡¶®</button>
                <p id="bonusTimer">‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶¨‡ßã‡¶®‡¶æ‡¶∏: <span id="countdown">24:00:00</span></p>
            </div>
        <div class="feature-card">
    <h3>‡¶è‡¶°‡¶∏ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡ßß</h3>
    <button id="adsClick1Btn" onclick="clickAd(1)">‡¶è‡¶°‡¶∏ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <p id="adsClick1Count">‡¶ï‡ßç‡¶≤‡¶ø‡¶ï: 0/300</p>
</div>
<div class="feature-card">
    <h3>‡¶è‡¶°‡¶∏ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡ß®</h3>
    <button id="adsClick2Btn" onclick="clickAd(2)">‡¶è‡¶°‡¶∏ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®</button>
    <p id="adsClick2Count">‡¶ï‡ßç‡¶≤‡¶ø‡¶ï: 0/300</p>
</div>
            <div class="feature-card">
                <h3>‡¶ü‡¶ø‡¶ï ‡¶ü‡¶æ‡¶ï ‡¶ó‡ßá‡¶Æ‡¶∏</h3>
                <button onclick="showGame()">‡¶ó‡ßá‡¶Æ ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶®</button>
            </div>

 <!-- <div class="feature-card">
                <h3>‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶™‡¶ø ‡¶¨‡¶æ‡¶∞‡ßç‡¶°</h3>
                <button onclick="showFlappyBird()">‡¶ó‡ßá‡¶Æ ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶®</button>
            </div>
            <div class="feature-card">
                <h3>‡¶Æ‡ßá‡¶Æ‡ßã‡¶∞‡¶ø ‡¶ó‡ßá‡¶Æ</h3>
                <button onclick="showMemoryGame()">‡¶ó‡ßá‡¶Æ ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶®</button>
            </div>
            <div class="feature-card">
                <h3>‡¶∏‡ßç‡¶™‡ßá‡¶∏ ‡¶á‡¶®‡¶≠‡ßá‡¶°‡¶æ‡¶∞</h3>
                <button onclick="showSpaceInvader()">‡¶ó‡ßá‡¶Æ ‡¶ñ‡ßá‡¶≤‡ßÅ‡¶®</button>
            </div> -->
        </div>
    </div>

    <div class="container" id="earning" style="display: none;">
        <h2>‡¶∞‡ßÅ‡¶≤‡¶∏</h2>
        <div class="feature-card">
            <h3>‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶∞‡ßÅ‡¶≤‡¶∏</h3>
            <p>1. ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶´‡ßá‡¶∏‡¶¨‡ßÅ‡¶ï ‡¶™‡ßá‡¶ú ‡¶≤‡¶æ‡¶á‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶´‡¶≤‡ßã ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
            <p>2. ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡ßã‡¶∏‡ßç‡¶ü‡¶ü‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶á‡¶Æ‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶∂‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® (‡¶™‡¶æ‡¶¨‡¶≤‡¶ø‡¶ï)‡•§</p>
            <p>3. ‡ß´ ‡¶ú‡¶® ‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶ï‡ßá ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡ßá‡¶ú‡¶ü‡¶ø ‡¶â‡¶≤‡ßç‡¶≤‡ßá‡¶ñ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
            <p>4. ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶™‡ßá‡¶ú‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∞‡¶ø‡¶≠‡¶ø‡¶â ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§</p>
        </div>
    </div>

    <div class="container" id="leaderboard" style="display: none;">
        <h2>‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶°</h2>
        <div class="leaderboard-container">
            <ul id="leaderboardList">
                <li class="loading">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</li>
            </ul>
        </div>
    </div>

    <div class="container" id="profile" style="display: none;">
        <h2>‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</h2>
        <div class="profile">
            <img id="profilePic" src="" alt="‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤ ‡¶õ‡¶¨‡¶ø">
            <p id="username"></p>
            <p id="userId"></p>
            <p>‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü: <span id="userPoints">0</span></p>
            <p>‡¶Æ‡ßã‡¶ü ‡¶è‡¶°‡¶∏ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï: <span id="totalAdsClicked">0</span></p>
        </div>
    </div>

<!-- ‡¶ó‡ßá‡¶Æ ‡¶∏‡ßá‡¶ï‡¶∂‡¶® -->
  <!--  <div class="container" id="gameSection" style="display: none;">
        <h2 id="currentGameTitle">‡¶ó‡ßá‡¶Æ‡¶∏</h2>
        <div class="game-container">
            <div id="flappyBirdGame" style="display: none;">
                <h3>‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶™‡¶ø ‡¶¨‡¶æ‡¶∞‡ßç‡¶°</h3>
                <canvas id="flappyCanvas" class="game-canvas" width="320" height="480"></canvas>
                <p id="flappyScore">‡¶∏‡ßç‡¶ï‡ßã‡¶∞: ‡ß¶</p>
                <button class="game-button" onclick="startFlappyBird()">‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
            <div id="memoryGame" style="display: none;">
                <h3>‡¶Æ‡ßá‡¶Æ‡ßã‡¶∞‡¶ø ‡¶ó‡ßá‡¶Æ</h3>
                <div id="memoryBoard" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;"></div>
                <p id="memoryScore">‡¶∏‡ßç‡¶ï‡ßã‡¶∞: ‡ß¶</p>
                <button class="game-button" onclick="startMemoryGame()">‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
            <div id="spaceInvaderGame" style="display: none;">
                <h3>‡¶∏‡ßç‡¶™‡ßá‡¶∏ ‡¶á‡¶®‡¶≠‡ßá‡¶°‡¶æ‡¶∞</h3>
                <canvas id="spaceCanvas" class="game-canvas" width="480" height="320"></canvas>
                <p id="spaceScore">‡¶∏‡ßç‡¶ï‡ßã‡¶∞: ‡ß¶</p>
                <button class="game-button" onclick="startSpaceInvader()">‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            </div>
        </div>
    </div> -->

<div class="container" id="gameSection" style="display: none;">
        <h2>‡¶ü‡¶ø‡¶ï-‡¶ü‡ßç‡¶Ø‡¶æ‡¶ï-‡¶ü‡ßã ‡¶ó‡ßá‡¶Æ</h2>
        <div class="game-container">
            <div class="game-info">
                <p>‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶ñ‡ßá‡¶≤‡ßã‡¶Ø‡¶º‡¶æ‡¶°‡¶º: <span id="currentPlayer">X</span></p>
                <p>‡¶ú‡¶Ø‡¶º: <span id="scoreX">0</span> - <span id="scoreO">0</span></p>
                <p>‡¶°‡¶ø‡¶´‡¶ø‡¶ï‡¶æ‡¶≤‡ßç‡¶ü‡¶ø ‡¶≤‡ßá‡¶≠‡ßá‡¶≤: 
                    <select id="difficultyLevel">
                        <option value="easy">‡¶∏‡¶π‡¶ú</option>
                        <option value="medium">‡¶Æ‡¶ß‡ßç‡¶Ø‡¶Æ</option>
                        <option value="hard">‡¶ï‡¶†‡¶ø‡¶®</option>
                    </select>
                </p>
            </div>
            <div id="gameBoard"></div>
            <button id="resetGame" onclick="resetGame()">‡¶®‡¶§‡ßÅ‡¶® ‡¶ñ‡ßá‡¶≤‡¶æ</button>
        </div>
    </div>


    <script>
       const GIST_ID = 'f944749344030d6228eed7b09b15d955';
        const APP_ID = '1162154'; // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ó‡¶ø‡¶ü‡¶π‡¶æ‡¶¨ ‡¶è‡¶™‡ßç‡¶∏ ‡¶Ü‡¶á‡¶°‡¶ø
        const INSTALLATION_ID = '61857809'; // ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶≤‡ßá‡¶∂‡¶® ‡¶Ü‡¶á‡¶°‡¶ø
        const PRIVATE_KEY = 'SHA256:8AfcOXOZUvYGEuuy6wmLFut1sq+0scouzssBu5v66HI=\n...'; // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶æ‡¶á‡¶≠‡ßá‡¶ü ‡¶ï‡ßÄ

        let userData = {
            userId: null,
            username: '',
            profilePic: '',
            points: 0,
            dailyBonusClaimed: false,
            adsClicked: [0, 0],
            lastBonusTime: null
        };

        const tg = window.Telegram.WebApp;
        tg.ready();

        let currentInstallationToken = null;
        let tokenExpiration = null;

        // ‡¶ú‡ßá‡¶è‡¶∏‡¶ì‡¶Ø‡¶º‡ßá‡¶¨ ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        function generateJWT() {
            const payload = {
                iat: Math.floor(Date.now() / 1000),
                exp: Math.floor(Date.now() / 1000) + 600, // 10 ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¨‡ßà‡¶ß
                iss: APP_ID
            };
            return jwt.sign(payload, PRIVATE_KEY, { algorithm: 'RS256' });
        }

        // ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶≤‡ßá‡¶∂‡¶® ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶ú‡ßá‡¶®‡¶æ‡¶∞‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        async function getInstallationToken() {
            const jwtToken = generateJWT();
            const response = await fetch(
                `https://api.github.com/app/installations/${INSTALLATION_ID}/access_tokens`,
                {
                    method: 'POST',
                    headers: {
                        Authorization: `Bearer ${jwtToken}`,
                        Accept: 'application/vnd.github.v3+json'
                    }
                }
            );
            const data = await response.json();
            return data.token;
        }

        // ‡¶ó‡¶ø‡¶ü‡¶π‡¶æ‡¶¨ ‡¶ü‡ßã‡¶ï‡ßá‡¶® ‡¶™‡ßá‡¶§‡ßá ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        async function getGitHubToken() {
            if (!currentInstallationToken || Date.now() > tokenExpiration) {
                currentInstallationToken = await getInstallationToken();
                tokenExpiration = Date.now() + 50 * 60 * 1000; // 50 ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
            }
            return currentInstallationToken;
        }

        // ‡¶ó‡¶ø‡¶∏‡ßç‡¶ü ‡¶°‡¶æ‡¶ü‡¶æ ‡¶´‡ßá‡¶ö ‡¶ï‡¶∞‡ßÅ‡¶®
        async function fetchGistData() {
            const token = await getGitHubToken();
            const response = await fetch(`https://api.github.com/gists/${GIST_ID}`, {
                headers: { Authorization: `token ${token}` }
            });
            const gist = await response.json();
            return JSON.parse(gist.files['data.json'].content);
        }

        // ‡¶ó‡¶ø‡¶∏‡ßç‡¶ü ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        async function updateGistData(data) {
            const token = await getGitHubToken();
            const response = await fetch(`https://api.github.com/gists/${GIST_ID}`, {
                method: 'PATCH',
                headers: {
                    Authorization: `token ${token}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    files: {
                        'data.json': {
                            content: JSON.stringify(data)
                        }
                    }
                })
            });
            return response.ok;
        }

        // ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
        function saveDataLocally(data) {
            localStorage.setItem('userData', JSON.stringify(data));
        }

        // ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤ ‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡ßá‡¶ú ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®
        function loadDataLocally() {
            return JSON.parse(localStorage.getItem('userData'));
        }

        // ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
        async function syncData() {
            const localData = loadDataLocally();
            if (localData) {
                try {
                    const remoteData = await fetchGistData();
                    const mergedData = mergeData(localData, remoteData);
                    await updateGistData(mergedData);
                    localStorage.removeItem('userData');
                    console.log('‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá:', localData);
                } catch (error) {
                    console.error('‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:', error);
                }
            }
        }

        // ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®
        function mergeData(local, remote) {
            if (remote[local.userId]) {
                const merged = {
                    ...remote[local.userId],
                    points: Math.max(remote[local.userId].points, local.points),
                    adsClicked: local.adsClicked.map((val, i) => Math.max(val, remote[local.userId].adsClicked[i] || 0)),
                    lastSync: new Date().toISOString()
                };
                return { ...remote, [local.userId]: merged };
            }
            return { ...remote, [local.userId]: local };
        }

        // ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß´ ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡¶ø‡¶ô‡ßç‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
        setInterval(syncData, 5 * 60 * 1000);

        // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®
        async function loadUserData() {
            const localData = loadDataLocally();
            if (localData) {
                userData = localData;
            } else {
                try {
                    const remoteData = await fetchGistData();
                    if (remoteData[userData.userId]) {
                        userData = remoteData[userData.userId];
                    } else {
                        await saveUserData();
                    }
                } catch (error) {
                    console.error('‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:', error);
                }
            }
        }

        // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
        async function saveUserData() {
            saveDataLocally(userData);
            await syncData();
        }

            async function loadUserData() {
        const localData = loadDataLocally();
        if (localData) {
            userData = localData;
        } else {
            const token = getCurrentToken();
            try {
                const response = await fetch(`https://api.github.com/gists/${GIST_ID}`, {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                const allUserData = JSON.parse(data.files['data.json'].content);

                if (allUserData[userData.userId]) {
                    userData = allUserData[userData.userId];
                } else {
                    await saveUserData();
                }
            } catch (error) {
                console.error('‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:', error);
                switchToNextToken();
                await loadUserData();
            }
        }
    }


        async function claimDailyBonus() {
            if (!userData.dailyBonusClaimed) {
                userData.points += 50;
                userData.dailyBonusClaimed = true;
                userData.lastBonusTime = new Date().toISOString();
                await saveUserData();
                updateUI();
                alert('‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
                startCountdown();
            } else {
                alert('‡¶Ü‡¶™‡¶®‡¶ø ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶¨‡ßã‡¶®‡¶æ‡¶∏ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡¶®‡•§');
            }
        }

async function clickAd(adNumber) {
    if (adNumber > 2) return;
    if (userData.adsClicked[adNumber - 1] < 300) {
        // ‡¶Æ‡¶®‡¶ø‡¶ü‡ßá‡¶ó‡ßá‡¶∞ ‡¶è‡¶° ‡¶∂‡ßã ‡¶ï‡¶∞‡ßÅ‡¶®
        show_9005441().then(() => {
            // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®
            userData.adsClicked[adNumber - 1]++;
            userData.points += 10; // ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡ßß‡ß¶ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡¶ø‡¶®
            saveUserData();
            updateUI();
            document.getElementById(`adsClick${adNumber}Count`).innerText = `‡¶ï‡ßç‡¶≤‡¶ø‡¶ï: ${userData.adsClicked[adNumber - 1]}/300`;
            alert('‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶! ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶ø ‡ßß‡ß¶ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßá‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡¶®‡•§');
        }).catch((error) => {
            console.error('‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:', error);
            alert('‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
        });
    } else {
        alert('‡¶è‡¶á ‡¶è‡¶°‡¶∏‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶≤‡¶ø‡¶Æ‡¶ø‡¶ü ‡¶∂‡ßá‡¶∑‡•§');
    }
}

        function startCountdown() {
            const countdownElement = document.getElementById('countdown');
            const nextBonusTime = new Date(userData.lastBonusTime).getTime() + 24 * 60 * 60 * 1000;

            const updateTimer = () => {
                const now = new Date().getTime();
                const diff = nextBonusTime - now;

                if (diff <= 0) {
                    userData.dailyBonusClaimed = false;
                    countdownElement.innerText = '00:00:00';
                    clearInterval(interval);
                    return;
                }

                const hours = Math.floor(diff / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);

                countdownElement.innerText = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            };

            const interval = setInterval(updateTimer, 1000);
            updateTimer();
        }

        async function loadLeaderboard() {
            const token = getCurrentToken();
            try {
                const response = await fetch(`https://api.github.com/gists/${GIST_ID}`, {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Content-Type': 'application/json'
                    }
                });
                const data = await response.json();
                const leaderboardData = JSON.parse(data.files['data.json'].content);
                const sortedData = Object.values(leaderboardData).sort((a, b) => b.points - a.points);

                const leaderboardList = document.getElementById('leaderboardList');
                leaderboardList.innerHTML = '';

                sortedData.forEach((user, index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `<span>${index + 1}. ID: ${user.userId}</span><span>${user.points} ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü</span>`;

                    if (index < 3) {
                        li.classList.add('top-three');
                    }

                    leaderboardList.appendChild(li);
                });
            } catch (error) {
                console.error('‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:', error);
                document.getElementById('leaderboardList').innerHTML = '<li>‡¶≤‡¶ø‡¶°‡¶æ‡¶∞‡¶¨‡ßã‡¶∞‡ßç‡¶° ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§</li>';
                switchToNextToken();
                await loadLeaderboard();
            }
        }

        function showHome() {
            document.getElementById('home').style.display = 'block';
            document.getElementById('earning').style.display = 'none';
            document.getElementById('leaderboard').style.display = 'none';
            document.getElementById('profile').style.display = 'none';
            document.getElementById('gameSection').style.display = 'none';
        }

        function showEarning() {
            document.getElementById('home').style.display = 'none';
            document.getElementById('earning').style.display = 'block';
            document.getElementById('leaderboard').style.display = 'none';
            document.getElementById('profile').style.display = 'none';
            document.getElementById('gameSection').style.display = 'none';
        }

        function showLeaderboard() {
            document.getElementById('home').style.display = 'none';
            document.getElementById('earning').style.display = 'none';
            document.getElementById('leaderboard').style.display = 'block';
            document.getElementById('profile').style.display = 'none';
            document.getElementById('gameSection').style.display = 'none';
            loadLeaderboard();
        }

        function showProfile() {
            document.getElementById('home').style.display = 'none';
            document.getElementById('earning').style.display = 'none';
            document.getElementById('leaderboard').style.display = 'none';
            document.getElementById('profile').style.display = 'block';
            document.getElementById('gameSection').style.display = 'none';
        }

        function showGame() {
            document.getElementById('home').style.display = 'none';
            document.getElementById('earning').style.display = 'none';
            document.getElementById('leaderboard').style.display = 'none';
            document.getElementById('profile').style.display = 'none';
            document.getElementById('gameSection').style.display = 'block';
            initGameBoard();

        // UI ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        function updateUI() {
            document.getElementById('dashboardProfilePic').src = userData.profilePic;
            document.getElementById('dashboardPoints').innerText = userData.points;
            document.getElementById('profilePic').src = userData.profilePic;
            document.getElementById('username').innerText = userData.username;
            document.getElementById('userId').innerText = `ID: ${userData.userId}`;
            document.getElementById('userPoints').innerText = userData.points;
            document.getElementById('totalAdsClicked').innerText = userData.adsClicked.reduce((a, b) => a + b, 0);
        }

        // ‡¶™‡ßá‡¶ú ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®
        window.onload = async function() {
            userData.userId = Telegram.WebApp.initDataUnsafe.user.id;
            userData.username = Telegram.WebApp.initDataUnsafe.user.username;
            userData.profilePic = Telegram.WebApp.initDataUnsafe.user.photo_url;

            await loadUserData();
            updateUI();
            if (userData.lastBonusTime) startCountdown();
            initGameBoard();
        }; 

      

        // ‡¶°‡ßç‡¶∞ ‡¶ö‡ßá‡¶ï
        function checkDraw() {
            return gameBoard.every(cell => cell !== '');
        }
 // ‡¶ú‡¶Ø‡¶º ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶≤‡¶æ‡¶∞
    async function handleWin() {
    isGameActive = false;
    scores[currentPlayer]++;
    updateScoreDisplay();
    
    if (currentPlayer === 'X') {
        // ‡¶Æ‡¶®‡¶ø‡¶ü‡ßá‡¶ó‡ßá‡¶∞ ‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°‡ßá‡¶° ‡¶™‡¶™‡¶Ü‡¶™ ‡¶è‡¶°‡¶∏ ‡¶∂‡ßã ‡¶ï‡¶∞‡ßÅ‡¶®
        show_9005441('pop').then(() => {
            // ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶∞‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®
            userData.points += 30; // ‡¶ú‡¶ø‡¶§‡¶≤‡ßá ‡ß©‡ß¶ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶¶‡¶ø‡¶®
            saveUserData();
            updateUI();
            alert('‡¶ú‡¶ø‡¶§‡ßá‡¶õ‡ßá‡¶®! ‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶™‡¶®‡¶ø ‡ß©‡ß¶ ‡¶™‡¶Ø‡¶º‡ßá‡¶®‡ßç‡¶ü ‡¶™‡ßá‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡¶®! üéâ');
        }).catch((error) => {
            console.error('‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:', error);
            alert('‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡¶æ‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§');
        });
    } else {
        alert('‡¶ï‡¶Æ‡ßç‡¶™‡¶ø‡¶â‡¶ü‡¶æ‡¶∞ ‡¶ú‡¶ø‡¶§‡ßá‡¶õ‡ßá! üò¢');
    }
    
    setTimeout(resetGame, 2000);
}

        // ‡¶°‡ßç‡¶∞ ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶≤‡¶æ‡¶∞
        function handleDraw() {
            isGameActive = false;
            alert('‡¶ñ‡ßá‡¶≤‡¶æ ‡¶°‡ßç‡¶∞! üòê');
            setTimeout(resetGame, 2000);
        }

        // ‡¶∏‡ßç‡¶ï‡ßã‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
        function updateScoreDisplay() {
            document.getElementById('scoreX').textContent = scores.X;
            document.getElementById('scoreO').textContent = scores.O;
        }

        // ‡¶ó‡ßá‡¶Æ ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü
   function resetGame() {
    gameBoard = ['', '', '', '', '', '', '', '', ''];
    currentPlayer = 'X';
    isGameActive = true;
    document.getElementById('currentPlayer').textContent = currentPlayer;
    document.querySelectorAll('.cell').forEach(cell => {
        cell.textContent = '';
    });
}

      


      
    </script>
</body>
</html>
